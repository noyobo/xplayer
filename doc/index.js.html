<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Xplayer API 文档</title>
    <meta name="description" content="MP3播放插件" />
    <meta name="keywords" content="audio,javascript" />
    <meta name="keyword" content="audio,javascript" />
    <meta property="og:title" content="Xplayer.js"/>
    <meta property="og:type" content="api"/>
    <meta property="og:image" content=""/>
    <meta property="og:site_name" content="Xplayer.js"/>
    <meta property="og:url" content="https://github.com/noyobo/xplayer"/>
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jaguar.css">
    
    
    <script>
    var config = {"monospaceLinks":true,"cleverLinks":true,"default":{"outputSourceFiles":true},"applicationName":"Xplayer.js","disqus":"xplayerjs","googleAnalytics":"UA-49864231-1","openGraph":{"title":"Xplayer.js","type":"api","image":"","site_name":"Xplayer.js","url":"https://github.com/noyobo/xplayer"},"meta":{"title":"Xplayer API 文档","description":"MP3播放插件","keyword":"audio,javascript"}};
    </script>
    

    
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', config.googleAnalytics]);
      _gaq.push(['_trackPageview']);
    
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation">
    <h3 class="applicationName"><a href="index.html">Xplayer.js</a></h3>

    <div class="search">
        <input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations">
    </div>
    <ul class="list">
    
        <li class="item" data-name="Xplayer.status">
            <span class="title">
                <a href="Xplayer.status.html">Xplayer.status</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="Xplayer.status#currentTime"><a href="Xplayer.status.html#currentTime">currentTime</a></li>
            
                <li data-name="Xplayer.status#duration"><a href="Xplayer.status.html#duration">duration</a></li>
            
                <li data-name="Xplayer.status#isPaused"><a href="Xplayer.status.html#isPaused">isPaused</a></li>
            
                <li data-name="Xplayer.status#isPlaying"><a href="Xplayer.status.html#isPlaying">isPlaying</a></li>
            
                <li data-name="Xplayer.status#loadedTime"><a href="Xplayer.status.html#loadedTime">loadedTime</a></li>
            
                <li data-name="Xplayer.status#pausePosition"><a href="Xplayer.status.html#pausePosition">pausePosition</a></li>
            
                <li data-name="Xplayer.status#volume"><a href="Xplayer.status.html#volume">volume</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Xplayer">
            <span class="title">
                <a href="Xplayer.html">Xplayer</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="Xplayer.player"><a href="Xplayer.html#player">player</a></li>
            
                <li data-name="Xplayer.track"><a href="Xplayer.html#track">track</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Xplayer.getTrack"><a href="Xplayer.html#getTrack">getTrack</a></li>
            
                <li data-name="Xplayer.load"><a href="Xplayer.html#load">load</a></li>
            
                <li data-name="Xplayer.on"><a href="Xplayer.html#on">on</a></li>
            
                <li data-name="Xplayer.pause"><a href="Xplayer.html#pause">pause</a></li>
            
                <li data-name="Xplayer.play"><a href="Xplayer.html#play">play</a></li>
            
                <li data-name="Xplayer.setPosition"><a href="Xplayer.html#setPosition">setPosition</a></li>
            
                <li data-name="Xplayer.setVolume"><a href="Xplayer.html#setVolume">setVolume</a></li>
            
                <li data-name="Xplayer.stop"><a href="Xplayer.html#stop">stop</a></li>
            
                <li data-name="Xplayer.supportAudio"><a href="Xplayer.html#supportAudio">supportAudio</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            <span class="subtitle">Events</span>
            
                <li data-name="Xplayer.event:ended"><a href="Xplayer.html#event:ended">ended</a></li>
            
                <li data-name="Xplayer.event:error"><a href="Xplayer.html#event:error">error</a></li>
            
                <li data-name="Xplayer.event:progress"><a href="Xplayer.html#event:progress">progress</a></li>
            
                <li data-name="Xplayer.event:timeupdate"><a href="Xplayer.html#event:timeupdate">timeupdate</a></li>
            
            </ul>
        </li>
    
    </ul>
</div>
    <div class="main">
        <h1 class="page-title" data-filename="index.js.html">Source: index.js</h1>
        


    
    <section>
        <article>
            <pre class="prettyprint source"><code>/**
 * @description MP3 播放核心插件
 * @author 宝码&lt;nongyoubao@alibaba-inc.com>
 * @version 1.0
 * @copyright www.noyobo.com
 */
KISSY.add(function(S, PlayerAudio, PlayerSwf) {
    'use strict';
    var EMPTY = '';
    /**
     * @name Xplayer
     * @class MP3播放组件
     * @constructor
     * @param {Object} [config] 播放器参数
     * @param {Boolean} [config.autoplay=false] 是否自动播放
     * @param {Boolean} [config.forceFlash=false] 强制使用Flash
     * @param {Boolean} [config.forceAudio=false] 强制使用Audio
     * @requires KISSY>1.4.0
     * @see http://docs.kissyui.com/
     * @example
     * 实例化 Xplayer
     * ```
     * var player = new Xplayer({
     *     'autoplay' : true
     * });
     * ```
     */

    function Xplayer(config) {
        var self = this;
        /**
         * 配置项
         * @type {Object}
         */
        self.config = S.mix({
            'autoplay': false,
            'forceFlash': false,
            'forceAudio': false
        }, config, true);
        // 立即初始化
        self._init();
    };

    Xplayer.prototype = {
        /**
         * 初始化Xplayer对象
         * @method Xplayer._init
         * @return {Xplayer} Xplayer对象
         * @private
         */
        _init: function() {
            var self = this;
            /**
             * Xplayer实例属性 Audio || swf
             * @name Xplayer.player
             * @readOnly
             * @type {Audio|Swf}
             */
            self.track = null;
            if (self.config.forceFlash) {
                self.player = new PlayerSwf();
                return self;
            };
            if (self.config.forceAudio) {
                self.player = new PlayerAudio();
                return self;
            };
            var isSupport = self.supportAudio();
            self.player = isSupport ? new PlayerAudio() : new PlayerSwf();
            //self.player = new PlayerSwf();

            /**
             * Xplayer实例属性,正在播放的歌曲 TrackVo 对象
             * @type {Object}
             * @name Xplayer.track
             * @readOnly
             * @example
             * Xplayer.getTrack() // {trackVo}
             * @see getTrack()
             */

            return self;
        },
        /**
         * 加载要播放的歌曲
         * @method Xplayer.load
         * @param  {Object} track 歌曲JSON对象
         * @param  {String} track.url 歌曲的MP3地址,必填!!
         * @return {Xplayer} Xplayer
         * @public
         * @example
         * var player = Xplayer();
         * plyaer.load({
         *     'url': 'http://example.com/kissy.mp3'
         * })
         */
        load: function(track) {
            var self = this;
            if (!track.url || track.url == EMPTY) {
                throw new Error("Can't find a URL parameter");
                return self;
            }
            self.stop();
            self.track = track;

            self.player.load(self.track.url);

            if (self.config.autoplay) {
                self.play();
            };
            return self;
        },
        /**
         * 监听事件的跳板实现
         * @method Xplayer.on
         * @param  {String}   event   事件名称
         * @param  {String} event.timeupdate 更新播放进度
         * @param  {String} event.ended 播放完成
         * @param  {Function} callback 回调函数
         * @return {Xplayer}            Xplayer对象
         * @example
         * var player = new Xplayer();
         * player.on("ended", function(e){
         *     alert( '播放结束了,需要做什么操作呢?' );
         * });
         */
        on: function(type, callback) {
            var self = this;
            self.player.on(type, callback);
            return self;
        },
        /**
         * 开始播放
         * @method Xplayer.play
         * @param {Number} [time=0] 从第几秒开始播放
         * @return {Xplayer}
         */
        play: function(time) {
            var self = this;
            if (isNaN(time) || S.isUndefined(time)) {
                time = 0;
            }
            self.player.play(time);
            return self;
        },
        /**
         * 停止播放
         * @method Xplayer.stop
         * @return {Xplayer} Xplayer
         */
        stop: function() {
            var self = this;
            self.player.stop();
            return self;
        },
        /**
         * 暂停播放
         * @method Xplayer.pause
         * @return {Xplayer} Xplayer
         */
        pause: function() {
            var self = this;
            self.player.pause();
            return self;
        },
        /**
         * 设置播放头位置
         * @method Xplayer.setPosition

         * @param {Number} [val=required] 播放头位置,单位S
         * @return {Xplayer} Xplayer
         */
        setPosition: function(val) {
            var self = this;
            if (S.isUndefined(val)) return self;
            self.player.setPosition(val);
            return self;
        },
        /**
         * 获取当前播放器TrackVo对象
         * @method Xplayer.getTrack
         * @return {Object} TrackVo
         */
        getTrack: function() {
            var self = this;
            return self.track;
        },
        /**
         * 设置音量
         * @method Xplayer.setVolume
         * @param {Number} val 音量大小
         */
        setVolume: function(val) {
            var self = this;
            self.player.setVolume(val)
        },
        /**
         * 支持Audio检测
         * @method Xplayer.supportAudio
         * @return {Boolean} 是否支持Audio
         */
        supportAudio: function() {
                var self = this;
                //audio/mpeg
                //application/octet-stream
                var a = document.createElement('audio');
                return !!(a.canPlayType && a.canPlayType('audio/mpeg').replace(/no/, ''));
            }
            /**
             * 正在播放中, 触发该事件
             * @event Xplayer.timeupdate
             * @param {Object} [data={currentTime:0, duration:1}] 返回内容
             * @return {Object} 返回状态
             */
            /**
             * 正在加载中, 触发该事件
             * @event Xplayer.progress
             * @param {Object} [data={progress:0, duration:1}] 返回内容
             * @return {Object} 返回状态
             */
            /**
             * 播放结束, 触发该事件
             * @event Xplayer.ended
             */
            /**
             * 播放错误, 触发该事件
             * @event Xplayer.error
             */
    }
    return Xplayer;
}, {
    requires: ['./plugin/audio', './plugin/audioSwf']
});
</code></pre>
        </article>
    </section>





        
        <!-- disqus code -->
        <div id="disqus_thread"></div>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        <!-- // disqus code -->
        

        <footer>
            Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.2</a> on Mon Jan 05 2015 16:45:15 GMT+0800 (CST)
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
<script src="scripts/main.js"></script>
</body>
</html>